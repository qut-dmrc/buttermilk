# Clean RAG Flow - Proper separation of tools and agents
# Demonstrates the modular approach with search tool + synthesis agent

defaults:
  - _self_
  # Load the search tool configuration
  - /tools@clean_rag.parameters.search_tool: chromadb_search/osb_search
  # Load the research agent
  - /agents@clean_rag.agents: 
    - research_agent
  # Host for coordination
  - /agents@clean_rag.observers:
    - host/llm_host
  # Storage configurations
  - /storage@clean_rag.storage: 
    - osb_json
    - osb_vector
  - /storage@clean_rag.parameters.save: flows
    
clean_rag:
  orchestrator: buttermilk.orchestrators.groupchat.AutogenOrchestrator
  name: "Clean RAG Flow"
  description: "Modular RAG with separate search tool and synthesis agent"

  parameters:
    # Host prompt focused on coordination
    assistant_prompt: |
      You are a research coordinator. When users ask questions:
      1. Direct the query to the RESEARCHER
      2. Let the RESEARCHER handle searching and synthesis
      3. Only intervene if clarification is needed
      
      The RESEARCHER has access to search tools and will:
      - Search the knowledge base
      - Refine searches if needed
      - Synthesize findings into clear answers
    
    human_in_loop: true
    websocket: true
    
  agents: {}
  observers: {}
  storage: {}
  
  # The search tool is configured via parameters.search_tool
  # and automatically provided to the research agent