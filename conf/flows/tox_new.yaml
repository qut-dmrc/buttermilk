# Improved toxicity flow using new configuration structure

defaults:
  - _self_
  - /data: tox_bigquery_new           # Use improved data config with storage template
  - /agents@agents.judge: judge       # Flow-independent agents
  - /agents@agents.synth: synth
  - /agents@agents.differences: differences
  - /agents@observers.spy: spy        # Observer agents  
  - /agents@observers.owl: owl
  - /agents@observers.scorer: scorer
  - /agents@observers.host: host/sequencer
  - /criteria@parameters.criteria: hate

# Core flow configuration
orchestrator: buttermilk.orchestrators.groupchat.AutogenOrchestrator
name: "tox"
description: "Applies toxicity criteria for content moderation"

# Flow-specific parameters
parameters:
  human_in_loop: ${run.human_in_loop}
  
  # Criteria configuration - can reference multiple criteria files
  criteria:
    - criteria_ordinary
    - criteria_gelber  
    - criteria_hatefb_factorised
  
  # Save configuration inherits from BM infrastructure
  save:
    type: bigquery
    dataset_id: ${data.dataset_id}
    table_id: flows
    dataset_name: ${name}

# Agent and observer configurations will be populated from defaults
agents: {}
observers: {}