# defaults:
#   - _self_

moa:
  _target_: buttermilk.runner.moa.MoA
  source: trans journalists guidelines assessment
  save: ${save}
  llms: ${llms.general}

  data:
    - name: tja_train
      type: file
      path: gs://prosocial-dev/data/tja_train.jsonl
      index:
        - record_id

  steps:
    # - name: describer
    #   num_runs: 1
    #   parameters:
    #     template: describe
    #     download_if_necessary: true
    #     model:
    #       - gemini2pro

    - name: context_owl
      _target_: buttermilk.agents.Owl
      num_runs: 1
      save: ${save}
      model: ${llms.general}
      template: owl
    - name: judge
      _target_: buttermilk.agents.Judger
      num_runs: 1
      save: ${save}
      model: ${llms.judgers}
      template: judge
      parameters:
        formatting: json_rules
        criteria:
          - criteria_ordinary
          - criteria_simple
      inputs:
        - record
        - context_owl
    - name: context_owl
      _target_: buttermilk.agents.Owl
      num_runs: 1
      save: ${save}
      model: ${llms.general}
      template: owl
    - name: synth
      _target_: buttermilk.agents.Synthesiser
      template: synthesise_judger
      num_runs: 1
      save: ${save}
      model: ${llms.synthesisers}
      parameters:
        instructions: judge
        criteria: criteria_simple
        formatting: json_rules
      inputs:
        - record
        - judge
        - context_owl
    # - name: eval
    #   num_runs: 1
    #   save: ${save}
    #   parameters:
    #     template: differences
    #     criteria: >
    #       Evaluate how well the provided content aligns with journalistic standards
    #       and best practices for reporting on stories related to trans people.
