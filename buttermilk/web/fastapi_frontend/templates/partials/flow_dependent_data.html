<div id="criteria-container">
    <select 
        id="criteria" 
        name="criteria" 
        class="select select-bordered w-full"
        x-model="selectedCriteria"
        hx-get="/dash/api/records/" 
        hx-include="[name='flow']" 
        hx-target="#record-container"
        hx-trigger="change"
        hx-indicator=".record-loader">
        <option value="">Select criteria</option>
        {% for criterion in criteria %}
        <option value="{{ criterion }}">{{ criterion }}</option>
        {% endfor %}
    </select>
</div>
<div class="criteria-loader htmx-indicator mt-2">
    <span class="loading loading-dots loading-sm"></span>
</div>
<div id="record-container">
    <select 
        id="record_id" 
        name="record_id" 
        class="select select-bordered w-full"
        x-model="selectedRecordId">
        <option value="">Select record ID</option>
        {% for record_id in record_ids %}
        <option value="{{ record_id }}">{{ record_id }}</option>
        {% endfor %}
    </select>
    <div class="record-loader htmx-indicator">
        <span class="loading loading-dots loading-sm mt-2"></span>
    </div>
</div>

<script>
    // Force Alpine.js to initialize this component
    document.addEventListener('DOMContentLoaded', function() {
        if (window.Alpine) {
            console.log('Re-initializing Alpine.js on flow-dependent-data container');
            window.Alpine.initTree(document.getElementById('flow-dependent-data'));
        }
    });
    </script>