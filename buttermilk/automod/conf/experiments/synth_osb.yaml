name: osb_synth
concurrent: 10
num_runs: 4
max_batch: 1

save:
  destination: bq
  dataset: dmrc-analysis.toxicity.step
  schema: buttermilk/schemas/step.json

init:
  template: synthesise
  formatting: json_rules
  criteria: criteria_ordinary

model:
  - gpt4o
  - sonnet
  - opus
  - gemini15pro

data:
  - name: draft
    type: job
    dataset: dmrc-analysis.toxicity.step_extracted
    last_n_days: 3
    max_records_per_group: 8
    filter:
      step: judge
    group:
      record_id: record_id
    columns:
      answers:
        id: job_id
        predicted: predicted
        reasons: outputs.reasons
        labels: labels
        scores: scores
    model:
      - gpt4o
      - sonnet
